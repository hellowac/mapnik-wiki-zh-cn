<!doctype html>
<html class="no-js" lang="zh-CN" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="索引" href="genindex.html" /><link rel="search" title="搜索" href="search.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Open solaris installation 64bit - mapnik-wiki-zh-cn 1.0 文档</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">mapnik-wiki-zh-cn 1.0 文档</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">mapnik-wiki-zh-cn 1.0 文档</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="搜索" name="q" aria-label="搜索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Introductory Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="About-Mapnik.html">About Mapnik</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mapnik-Installation.html">Mapnik Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="LearningMapnik.html">Learning Mapnik</a></li>
<li class="toctree-l1"><a class="reference internal" href="Notes-and-caveats.html">Notes and caveats</a></li>
<li class="toctree-l1"><a class="reference internal" href="Related-projects-and-utilities.html">Related projects and utilties</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Mapnik API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="XMLConfigReference.html">Mapnik configuration XML</a></li>
<li class="toctree-l1"><a class="reference internal" href="SymbologySupport.html">Symbology Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="PluginArchitecture.html">Plugin Architecture</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/mapnik/mapnik/blob/master/INSTALL.md">Building Mapnik</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mapnik2.html">Mapnik2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="MapnikReleases.html">Mapnik Releases</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://groups.google.com/forum/#!forum/mapnik">Mailing List</a></li>
<li class="toctree-l1"><a class="reference external" href="http://webchat.freenode.net/?channels=#mapnik">#mapnik channel on irc.freenode.net Webchat</a></li>
<li class="toctree-l1"><a class="reference internal" href="Code-sprint.html">Code sprint</a></li>
<li class="toctree-l1"><a class="reference external" href="http://173.255.217.246:8000/mapnik_trac/wiki/MapnikCodeSprint/MCS01">Code sprint 2010 - Committers and Cartographers London, England, 24-26 September 2010</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/OpenSolarisInstallation_64bit.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <!-- Name: OpenSolarisInstallation/64bit -->
<!-- Version: 4 -->
<!-- Last-Modified: 2010/12/08 14:52:04 -->
<!-- Author: springmeyer -->
<section class="tex2jax_ignore mathjax_ignore" id="open-solaris-installation-64bit">
<h1>Open solaris installation 64bit<a class="headerlink" href="#open-solaris-installation-64bit" title="Link to this heading">¶</a></h1>
<p>For the main install page see: <a class="reference external" href="https://github.com/mapnik/mapnik/wiki/OpenSolarisInstallation">https://github.com/mapnik/mapnik/wiki/OpenSolarisInstallation</a> part InstallingCoreMapnikDependencies</p>
<section id="b-64-bit-postgres-8-3-from-sun">
<h2>6b: 64 bit - Postgres 8.3 from sun<a class="headerlink" href="#b-64-bit-postgres-8-3-from-sun" title="Link to this heading">¶</a></h2>
<p>NOTE: next step on improving this approach will be to test using Postgres 9.0 and Python &gt;= 2.6 from source, but all 64 bit.</p>
<section id="getting-64-bit-builds">
<h3>Getting 64 bit builds<a class="headerlink" href="#getting-64-bit-builds" title="Link to this heading">¶</a></h3>
<p>In a best case scenario building a tool 64 bit should be easy if:</p>
<ol class="arabic simple">
<li><p>you can easily pass a few custom CFLAGS and LDFLAGS</p></li>
<li><p>all the dependencies of that library are also 64 bit and PIC code.</p></li>
</ol>
<p>So, sometime it is as easy as:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>export CFLAGS=&#39;-m64&#39;
export CXXFLAGS=&#39;-m64&#39;
export LDFLAGS=&#39;-m64 -R/usr/local/lib&#39;
./configure
make
pfexec make install
</pre></div>
</div>
<p>But, lots can go wrong, including:</p>
<ol class="arabic simple">
<li><p>code is not properly PIC</p></li>
<li><p>different compilers are being invoked during configure such that passing those env flags cause the configure to fail</p></li>
<li><p>older built tools (gcc, libtool, etc) are invoked and flags conflict in 64 bit mode, like -mt, or -M or -tag=CC</p></li>
<li><p>the built scripts don't properly propogate your custom flags so that some code is built 32 bit and libraries fail with the -m64 flag</p></li>
<li><p>some built scripts pull env variables from other apps compiled both 32 and 64 bit (like sun provided postgres)</p></li>
</ol>
<ul class="simple">
<li><p>in this case you <em>must</em> have the 64bit commands on your path, such as PATH=/usr/postgres/bin/amd64</p></li>
</ul>
<p>To get started first we set up a few environment variables</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="nv">TARGET</span><span class="o">=</span><span class="s2">&quot;~/.bashrc&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;export PATH=/usr/bin/amd64:/opt/ts/gcc/4.4/bin/:/opt/ts/bin:/usr/local/bin/:/usr/postgres/8.3/bin/amd64:$PATH&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="nv">$TARGET</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;export PYTHONPATH=/usr/local/lib/python2.6/site-packages:$PYTHONPATH&#39;</span><span class="w"> </span>&gt;&gt;<span class="w">  </span><span class="nv">$TARGET</span>
<span class="w">    </span><span class="nb">source</span><span class="w"> </span><span class="nv">$TARGET</span>
</pre></div>
</div>
<p>Also command like this was needed with the 32 bit approach but appear unneeded with this 64 bit approach:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="n">echo</span> <span class="s1">&#39;export LD_LIBRARY_PATH=/usr/local/lib:/usr/postgres/8.3/lib/amd64&#39;</span> <span class="o">&gt;&gt;</span>  <span class="err">$</span><span class="n">TARGET</span>
    <span class="n">echo</span> <span class="s1">&#39;export LANG=&quot;C&quot;&#39;</span> <span class="o">&gt;&gt;</span>  <span class="err">$</span><span class="n">TARGET</span>
    <span class="n">echo</span> <span class="s1">&#39;export LC_ALL=&quot;C&quot;&#39;</span> <span class="o">&gt;&gt;</span> <span class="err">$</span><span class="n">TARGET</span>
</pre></div>
</div>
<p>Then set up a build area:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1"># set up a directory for source builds of familiar geo libs</span>
<span class="w">    </span>mkdir<span class="w"> </span>src
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">SRC</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>/src
</pre></div>
</div>
<p>Then get on with the installs</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1"># icu</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$SRC</span>
<span class="w">    </span>wget<span class="w"> </span>http://download.icu-project.org/files/icu4c/4.4.1/icu4c-4_4_1-src.tgz
<span class="w">    </span>tar<span class="w"> </span>xvf<span class="w"> </span>icu4c-4_4_1-src.tgz
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>icu/source
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">CXX</span><span class="o">=</span><span class="s1">&#39;/opt/ts/gcc/4.4/bin/g++&#39;</span>
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">CC</span><span class="o">=</span><span class="s1">&#39;/opt/ts/gcc/4.4/bin/gcc&#39;</span>
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">CFLAGS</span><span class="o">=</span><span class="s1">&#39;-m64&#39;</span>
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">CXXFLAGS</span><span class="o">=</span><span class="s1">&#39;-m64&#39;</span>
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">LDFLAGS</span><span class="o">=</span><span class="s1">&#39;-m64 -R/usr/local/lib&#39;</span>
<span class="w">    </span>./runConfigureICU<span class="w"> </span>Solaris/GCC<span class="w"> </span>--with-library-bits<span class="o">=</span><span class="m">64</span>
<span class="w">    </span>make
<span class="w">    </span>pfexec<span class="w"> </span>make<span class="w"> </span>install
</pre></div>
</div>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1"># boost</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$SRC</span>
<span class="w">    </span>wget<span class="w"> </span>wget<span class="w"> </span>http://voxel.dl.sourceforge.net/project/boost/boost/1.45.0/boost_1_45_0.tar.bz2
<span class="w">    </span>tar<span class="w"> </span>xjvf<span class="w"> </span>boost_1_45_0.tar.bz2
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>boost_1_45_0
<span class="w">    </span><span class="c1"># create jam file to configure</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;using gcc : 4.4 : /opt/ts/gcc/4.4/bin/g++ ; &quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>tools/build/v2/user-config.jam
<span class="w">    </span>./bootstrap.sh
<span class="w">    </span>./bjam<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-q<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-d2<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--with-thread<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--with-filesystem<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--with-iostreams<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--with-python<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--with-program_options<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--with-system<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--with-regex<span class="w"> </span>-sHAVE_ICU<span class="o">=</span><span class="m">1</span><span class="w"> </span>-sICU_PATH<span class="o">=</span>/usr/local<span class="w">  </span><span class="se">\</span>
<span class="w">      </span><span class="nv">toolset</span><span class="o">=</span>gcc<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>address-model<span class="o">=</span><span class="m">64</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span><span class="nv">link</span><span class="o">=</span>shared<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>release<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>stage
<span class="w">    </span>
<span class="w">    </span>pfexec<span class="w"> </span>./bjam<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-q<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-d2<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--with-thread<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--with-filesystem<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--with-iostreams<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--with-python<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--with-program_options<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--with-system<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--with-regex<span class="w"> </span>-sHAVE_ICU<span class="o">=</span><span class="m">1</span><span class="w"> </span>-sICU_PATH<span class="o">=</span>/usr/local<span class="w">  </span><span class="se">\</span>
<span class="w">      </span><span class="nv">toolset</span><span class="o">=</span>gcc<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>address-model<span class="o">=</span><span class="m">64</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span><span class="nv">link</span><span class="o">=</span>shared<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>release<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>install
</pre></div>
</div>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1"># proj</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$SRC</span>
<span class="w">    </span><span class="nv">VER</span><span class="o">=</span><span class="m">4</span>.7.0
<span class="w">    </span>wget<span class="w"> </span>http://download.osgeo.org/proj/proj-<span class="nv">$VER</span>.tar.gz
<span class="w">    </span>wget<span class="w"> </span>ftp://ftp.remotesensing.org/proj/proj-datumgrid-1.5.zip
<span class="w">    </span>tar<span class="w"> </span>xzf<span class="w"> </span>proj-<span class="nv">$VER</span>.tar.gz
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>proj-<span class="nv">$VER</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>nad
<span class="w">    </span>unzip<span class="w"> </span>../../proj-datumgrid-1.5.zip
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>..
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">CFLAGS</span><span class="o">=</span><span class="s1">&#39;-m64&#39;</span>
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">CXXFLAGS</span><span class="o">=</span><span class="s1">&#39;-m64&#39;</span>
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">LDFLAGS</span><span class="o">=</span><span class="s1">&#39;-m64 -R/usr/local/lib&#39;</span>
<span class="w">    </span>./configure
<span class="w">    </span>make
<span class="w">    </span>pfexec<span class="w"> </span>make<span class="w"> </span>install
</pre></div>
</div>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1"># geos</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$SRC</span>
<span class="w">    </span><span class="nv">VER</span><span class="o">=</span><span class="m">3</span>.2.0
<span class="w">    </span>wget<span class="w"> </span>http://download.osgeo.org/geos/geos-<span class="nv">$VER</span>.tar.bz2
<span class="w">    </span>tar<span class="w"> </span>xjf<span class="w"> </span>geos-<span class="nv">$VER</span>.tar.bz2
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>geos-<span class="nv">$VER</span>
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">CFLAGS</span><span class="o">=</span><span class="s1">&#39;-m64&#39;</span>
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">CXXFLAGS</span><span class="o">=</span><span class="s1">&#39;-m64&#39;</span>
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">LDFLAGS</span><span class="o">=</span><span class="s1">&#39;-m64 -R/usr/local/lib&#39;</span>
<span class="w">    </span>./configure
<span class="w">    </span>make
<span class="w">    </span>pfexec<span class="w"> </span>make<span class="w"> </span>install
</pre></div>
</div>
<p>For postgres we use the sun provided version (for better or worse):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="c1"># install postgres 8.3 from sun</span>
    <span class="n">pfexec</span> <span class="n">pkg</span> <span class="n">install</span> <span class="n">SUNWpostgr</span><span class="o">-</span><span class="mi">83</span><span class="o">-</span><span class="n">server</span> <span class="n">SUNWpostgr</span><span class="o">-</span><span class="mi">83</span><span class="o">-</span><span class="n">devel</span> <span class="n">SUNWpostgr</span><span class="o">-</span><span class="mi">83</span><span class="o">-</span><span class="n">client</span> <span class="n">SUNWpostgr</span><span class="o">-</span><span class="mi">83</span><span class="o">-</span><span class="n">contrib</span>
</pre></div>
</div>
<p>Setup postgres</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="n">pfexec</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">database</span><span class="o">/</span><span class="n">pgdata</span>
    <span class="n">pfexec</span> <span class="n">chown</span> <span class="n">postgres</span><span class="p">:</span><span class="n">postgres</span> <span class="o">/</span><span class="n">database</span><span class="o">/</span><span class="n">pgdata</span>
    <span class="n">pfexec</span> <span class="n">su</span> <span class="o">-</span> <span class="n">postgres</span> 
    <span class="n">export</span> <span class="n">PATH</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="mf">8.3</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">amd64</span><span class="p">:</span><span class="err">$</span><span class="n">PATH</span>
    <span class="n">initdb</span> <span class="o">/</span><span class="n">database</span><span class="o">/</span><span class="n">pgdata</span>
    <span class="n">pg_ctl</span> <span class="o">-</span><span class="n">D</span> <span class="o">/</span><span class="n">database</span><span class="o">/</span><span class="n">pgdata</span> <span class="o">-</span><span class="n">l</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">log</span> <span class="n">start</span>
</pre></div>
</div>
<p>Install postgres (compiled with gcc) against sun provided postgres (likely compiled with ancient suncc version). This is dangerous, but it worked.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1"># postgis</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$SRC</span>
<span class="w">    </span><span class="nv">VER</span><span class="o">=</span><span class="m">1</span>.5.1
<span class="w">    </span>wget<span class="w"> </span>http://postgis.refractions.net/download/postgis-<span class="nv">$VER</span>.tar.gz
<span class="w">    </span>tar<span class="w"> </span>xvf<span class="w"> </span>postgis-<span class="nv">$VER</span>.tar.gz
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>postgis-<span class="nv">$VER</span>
<span class="w">    </span>./configure<span class="w"> </span>--with-projdir<span class="o">=</span>/usr/local/
<span class="w">    </span><span class="c1"># this below command could be greatly simplified, but it finally worked so there you go. I think the missing secret was simple `-shared`</span>
<span class="w">    </span>pfexec<span class="w"> </span>make<span class="w"> </span><span class="nv">CC</span><span class="o">=</span><span class="s2">&quot;gcc -shared -m64 -O2 -fPIC -DPIC&quot;</span><span class="w"> </span><span class="nv">CXX</span><span class="o">=</span><span class="s2">&quot;g++ -shared -m64 -O2 -fPIC -DPIC&quot;</span><span class="w"> </span><span class="nv">CFLAGS</span><span class="o">=</span><span class="s2">&quot;-m64 -O2 -fPIC -DPIC&quot;</span><span class="w"> </span><span class="nv">CXXFLAGS</span><span class="o">=</span><span class="s2">&quot;-m64 -O2 -fPIC -DPIC&quot;</span><span class="w"> </span><span class="nv">CFLAGS_SL</span><span class="o">=</span><span class="s1">&#39;-m64 -O2 -fPIC -DPIC&#39;</span><span class="w"> </span><span class="nv">LDFLAGS_SL</span><span class="o">=</span><span class="s1">&#39;-m64 -O2 -fPIC -DPIC -R/usr/local/lib -R/usr/postgres/8.3/lib/amd64&#39;</span>
<span class="w">    </span>pfexec<span class="w"> </span>make<span class="w"> </span>install
<span class="w">    </span><span class="c1"># passing -R/usr/local/lib for the runpath still does not allow libpostgis.so to find proj4 and geos when running `psql -f postgis.sql`</span>
<span class="w">    </span><span class="c1"># so symlink them into the same directory as an workaround</span>
<span class="w">    </span>pfexec<span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span>/usr/local/lib/libproj.so.0<span class="w"> </span>/usr/postgres/8.3/lib/amd64/libproj.so.0
<span class="w">    </span>pfexec<span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span>/usr/local/lib/libgeos_c.so.1<span class="w"> </span>/usr/postgres/8.3/lib/amd64/libgeos_c.so.1
</pre></div>
</div>
<p>The goal with the nasty bit of flags above is to force the proper gcc + 64 bit build environment for postgis to work at runtime. This is tricky because the sun postgres tries to tell postgis to compile using hardcoded paths to compilers that don't even exist for open solaris (due to pg_config) and also because we cannot modify these settings except by overrides to <code class="docutils literal notranslate"><span class="pre">make</span></code> (not configure).</p>
<p>Mainly we are trying to avoid this error:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>psql:/usr/postgres/8.3/share/contrib/postgis-1.5/postgis.sql:59: ERROR:  could not load library &quot;/usr/postgres/8.3/lib/amd64/postgis-1.5.so&quot;: ld.so.1: postgres: fatal: relocation error: R_AMD64_PC32: file /usr/postgres/8.3/lib/amd64/postgis-1.5.so: symbol main: value 0x28003ed8ab4 does not fit
</pre></div>
</div>
<p>Now set up postgis:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1"># create the template_postgis db</span>
<span class="w">    </span>pfexec<span class="w"> </span>su<span class="w"> </span>-<span class="w"> </span>postgres
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span>/usr/local/bin:/usr/postgres/8.3/bin/amd64/:<span class="nv">$PATH</span>
<span class="w">    </span><span class="nv">POSTGIS_SQL_PATH</span><span class="o">=</span><span class="sb">`</span>pg_config<span class="w"> </span>--sharedir<span class="sb">`</span>/contrib/postgis-1.5
<span class="w">    </span>createdb<span class="w"> </span>-E<span class="w"> </span>UTF8<span class="w"> </span>template_postgis
<span class="w">    </span>createlang<span class="w"> </span>-d<span class="w"> </span>template_postgis<span class="w"> </span>plpgsql
<span class="w">    </span>psql<span class="w"> </span>-q<span class="w"> </span>-d<span class="w"> </span>template_postgis<span class="w"> </span>-f<span class="w"> </span><span class="nv">$POSTGIS_SQL_PATH</span>/postgis.sql
<span class="w">    </span>psql<span class="w"> </span>-q<span class="w"> </span>-d<span class="w"> </span>template_postgis<span class="w"> </span>-f<span class="w"> </span><span class="nv">$POSTGIS_SQL_PATH</span>/spatial_ref_sys.sql
<span class="w">    </span><span class="c1"># now switch back to your normal user</span>
<span class="w">    </span><span class="nb">exit</span>
</pre></div>
</div>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1"># gdal</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$SRC</span>
<span class="w">    </span><span class="nv">VER</span><span class="o">=</span><span class="m">1</span>.7.2
<span class="w">    </span>wget<span class="w"> </span>http://download.osgeo.org/gdal/gdal-<span class="nv">$VER</span>.tar.gz
<span class="w">    </span>tar<span class="w"> </span>xzf<span class="w"> </span>gdal-<span class="nv">$VER</span>.tar.gz
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>gdal-<span class="nv">$VER</span>
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">CFLAGS</span><span class="o">=</span><span class="s1">&#39;-m64&#39;</span>
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">CXXFLAGS</span><span class="o">=</span><span class="s1">&#39;-m64&#39;</span>
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">LDFLAGS</span><span class="o">=</span><span class="s1">&#39;-m64 -R/usr/local/lib&#39;</span>
<span class="w">    </span>./configure<span class="w"> </span>--with-proj<span class="w"> </span>--with-geos<span class="w"> </span>--with-postgres
<span class="w">    </span>make
<span class="w">    </span>pfexec<span class="w"> </span>make<span class="w"> </span>install
</pre></div>
</div>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1"># osm2pgsql</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$SRC</span>
<span class="w">    </span><span class="c1">#svn co http://svn.openstreetmap.org/applications/utils/export/osm2pgsql/</span>
<span class="w">    </span><span class="c1"># grab a hard revision that we know works on solaris (based on wikipedia usage, although they compile with suncc)</span>
<span class="w">    </span>svn<span class="w"> </span>co<span class="w"> </span>-r<span class="w"> </span><span class="m">19933</span><span class="w"> </span>http://svn.openstreetmap.org/applications/utils/export/osm2pgsql/
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>osm2pgsql
</pre></div>
</div>
<p>Apply patch</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="w"> </span>   Index: Makefile
<span class="w"> </span>   ===================================================================
<span class="w"> </span>   --- Makefile    (revision 19933)
<span class="w"> </span>   +++ Makefile    (working copy)
<span class="w"> </span>   @@ -22,6 +22,7 @@
<span class="w"> </span>    LDFLAGS += -g -lproj
<span class="w"> </span>    LDFLAGS += -lstdc++
<span class="w"> </span>    LDFLAGS += -lpthread
<span class="w"> </span>   +LDFLAGS += -R/usr/postgres/8.3/lib -R/opt/ts/lib -R/usr/local/lib
<span class="w"> </span>    
<span class="w"> </span>    SRCS:=$(wildcard *.c) $(wildcard *.cpp)
<span class="w"> </span>    OBJS:=$(SRCS:.c=.o)
</pre></div>
</div>
<p>finish install</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="w">    </span>make
<span class="w">    </span>pfexec<span class="w"> </span>cp<span class="w"> </span>osm2pgsql<span class="w"> </span>/usr/local/bin
<span class="w">    </span>pfexec<span class="w"> </span>chmod<span class="w"> </span>+x<span class="w"> </span>/usr/local/bin/osm2pgsql
<span class="w">    </span>pfexec<span class="w"> </span>mkdir<span class="w"> </span>/usr/share/osm2pgsql
<span class="w">    </span><span class="c1"># get latest style and install</span>
<span class="w">    </span>svn<span class="w"> </span>up<span class="w"> </span>default.style
<span class="w">    </span>pfexec<span class="w"> </span>cp<span class="w"> </span>default.style<span class="w"> </span>/usr/share/osm2pgsql/
</pre></div>
</div>
</section>
</section>
<section id="other-stuff">
<h2>Other stuff<a class="headerlink" href="#other-stuff" title="Link to this heading">¶</a></h2>
<p>Apache, mod_wsgi, tilecache, pil...</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>export CFLAGS=&#39;-m64&#39;
export CXXFLAGS=&#39;-m64&#39;
export LDFLAGS=&#39;-m64 -R/usr/local/lib&#39;

# apr
wget http://mirrors.dedipower.com/ftp.apache.org/apr/apr-1.4.2.tar.gz

# apr util
wget http://apache.ziply.com//apr/apr-util-1.3.10.tar.gz
tar xvf apr-util-1.3.10.tar.gz
./configure --with-apr=/usr/local/apr/bin/apr-1-config

# httpd:
./configure --with-apr=/usr/local/apr/bin/apr-1-config --with-apr-util=/usr/local/apr/bin/apu-1-config

# mod_wsgi
export PATH=/usr/local/apache2/bin/:$PATH
./configure --with-apxs=/usr/local/apache2/bin/apxs --with-python=/usr/bin/amd64/python
make
pfexec make install

# now start apache
pfexec /usr/local/apache2/bin/httpd -k start
</pre></div>
</div>
<p>Python PIL Imaging is not built 64 bit via packages (there is no site-packages/PIL/64/_imaging.so) so do:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># uninstall old version
pfexec pkg uninstall python-imaging-26

# use the sun tools to compile python apps that use pure c libs:
export PATH=/opt/sunstudio12.1/bin:/usr/gnu/bin/amd64:/usr/gnu/bin:/usr/bin/amd64:/usr/bin:/bin/amd64:/bin:/usr/sbin/amd64:/usr/sbin:/sbin:/usr/X11/bin/amd64
CFLAGS=&quot;-m64&quot; python setup.py build
pfexec /usr/bin/amd64/python setup.py install --prefix=/usr/local
</pre></div>
</div>
<p>ensure:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ file /usr/local/lib/python2.6/site-packages/PIL/64/_imaging.so 
/usr/local/lib/python2.6/site-packages/PIL/64/_imaging.so:      ELF 64-bit LSB dynamic lib AMD64 Version 1, dynamically linked, not stripped, no debugging information available
</pre></div>
</div>
<p>Also can test PIL is 64 and PIC with:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import ctypes
import PIL.Image
PIL.Image.core.new(4,4)
ctypes.CDLL(&#39;/usr/local/lib/python2.6/site-packages/PIL/64/_imaging.so&#39;)
</pre></div>
</div>
<p>TileCache gocha:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># now source installed PIL does not support `import Image`, so we change the imports in TC:
pfexec vim TileCache/Layer.py
# replace import Image with import PIL.Image as Image
</pre></div>
</div>
<p>More info: <a class="reference external" href="http://trac.osgeo.org/tilecache/ticket/26">http://trac.osgeo.org/tilecache/ticket/26</a></p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, hellowac
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Open solaris installation 64bit</a><ul>
<li><a class="reference internal" href="#b-64-bit-postgres-8-3-from-sun">6b: 64 bit - Postgres 8.3 from sun</a><ul>
<li><a class="reference internal" href="#getting-64-bit-builds">Getting 64 bit builds</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-stuff">Other stuff</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=f115507d"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/translations.js?v=beaddf03"></script>
    </body>
</html>