<!doctype html>
<html class="no-js" lang="zh-CN" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="索引" href="genindex.html" /><link rel="search" title="搜索" href="search.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Image IO - mapnik-wiki-zh-cn 1.0 文档</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">mapnik-wiki-zh-cn 1.0 文档</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">mapnik-wiki-zh-cn 1.0 文档</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="搜索" name="q" aria-label="搜索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Introductory Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="About-Mapnik.html">About Mapnik</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mapnik-Installation.html">Mapnik Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="LearningMapnik.html">Learning Mapnik</a></li>
<li class="toctree-l1"><a class="reference internal" href="Notes-and-caveats.html">Notes and caveats</a></li>
<li class="toctree-l1"><a class="reference internal" href="Related-projects-and-utilities.html">Related projects and utilties</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Mapnik API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="XMLConfigReference.html">Mapnik configuration XML</a></li>
<li class="toctree-l1"><a class="reference internal" href="SymbologySupport.html">Symbology Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="PluginArchitecture.html">Plugin Architecture</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/mapnik/mapnik/blob/master/INSTALL.md">Building Mapnik</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mapnik2.html">Mapnik2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="MapnikReleases.html">Mapnik Releases</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://groups.google.com/forum/#!forum/mapnik">Mailing List</a></li>
<li class="toctree-l1"><a class="reference external" href="http://webchat.freenode.net/?channels=#mapnik">#mapnik channel on irc.freenode.net Webchat</a></li>
<li class="toctree-l1"><a class="reference internal" href="Code-sprint.html">Code sprint</a></li>
<li class="toctree-l1"><a class="reference external" href="http://173.255.217.246:8000/mapnik_trac/wiki/MapnikCodeSprint/MCS01">Code sprint 2010 - Committers and Cartographers London, England, 24-26 September 2010</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/Image-IO.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="image-io">
<h1>Image IO<a class="headerlink" href="#image-io" title="Link to this heading">¶</a></h1>
<p>Mapnik supports reading and writing a variety of image formats.</p>
<p>These formats can be used as:</p>
<ul class="simple">
<li><p>Output formats for rendered map tiles</p></li>
<li><p>Input formats for symbols or icons for symbolizers like the <a class="reference internal" href="MarkersSymbolizer.html"><span class="doc std std-doc">MarkersSymbolizer</span></a></p></li>
<li><p>Input formats for the <a class="reference internal" href="Raster.html"><span class="doc std std-doc">Raster</span></a> datasource plugin. Note: if you are looking for what raster geodata formats are supported see also what the <a class="reference internal" href="GDAL.html"><span class="doc std std-doc">GDAL</span></a> datasource plugin supports.</p></li>
</ul>
<section id="format-strings">
<h2>Format strings<a class="headerlink" href="#format-strings" title="Link to this heading">¶</a></h2>
<p>Mapnik functions like <code class="docutils literal notranslate"><span class="pre">mapnik.Image.save</span></code> in python or <code class="docutils literal notranslate"><span class="pre">mapnik::save_to_string</span></code> in C++ accept a string for various image formats. The string assumes a format like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">format</span><span class="p">:</span><span class="n">key</span><span class="o">=</span><span class="n">value</span>
</pre></div>
</div>
<p>So, for example to create a full color, 32 bit PNG with a custom compression level you could do:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">im</span> <span class="o">=</span> <span class="n">mapnik</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span><span class="mi">256</span><span class="p">)</span>
<span class="n">im</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;file.png&#39;</span><span class="p">,</span><span class="s1">&#39;png32:z=1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">z</span></code> indicates the <code class="docutils literal notranslate"><span class="pre">zlib</span></code> encoding option and <code class="docutils literal notranslate"><span class="pre">1</span></code> indicates the value, in this case <code class="docutils literal notranslate"><span class="pre">Z_BEST_SPEED</span></code> or fast compression at the expense of larger size. See below for all PNG options. Also note that the above code creates a blank image - in a real world situation you would likely use <code class="docutils literal notranslate"><span class="pre">mapnik.render</span></code> to render map data to the image before saving it.</p>
</section>
<section id="supported-formats">
<h2>Supported Formats<a class="headerlink" href="#supported-formats" title="Link to this heading">¶</a></h2>
<p>As of Mapnik 2.3.x the following formats are supported:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Format</p></th>
<th class="head text-right"><p>Read</p></th>
<th class="head text-right"><p>Write</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PNG</p></td>
<td class="text-right"><p>✓</p></td>
<td class="text-right"><p>✓</p></td>
</tr>
<tr class="row-odd"><td><p>JPEG</p></td>
<td class="text-right"><p>✓</p></td>
<td class="text-right"><p>✓</p></td>
</tr>
<tr class="row-even"><td><p>TIFF</p></td>
<td class="text-right"><p>✓</p></td>
<td class="text-right"><p>experimental</p></td>
</tr>
<tr class="row-odd"><td><p>WEBP</p></td>
<td class="text-right"><p>experimental</p></td>
<td class="text-right"><p>experimental</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="default-output-details">
<h2>Default output details<a class="headerlink" href="#default-output-details" title="Link to this heading">¶</a></h2>
<p>In Mapnik &gt;= 2.3.x by default:</p>
<ul class="simple">
<li><p>PNG output is full color png (aka. <code class="docutils literal notranslate"><span class="pre">png24</span></code> or <code class="docutils literal notranslate"><span class="pre">png32</span></code>)</p></li>
<li><p>JPEG output uses a <code class="docutils literal notranslate"><span class="pre">quality</span></code> of 85.</p></li>
<li><p>TIFF output uses <code class="docutils literal notranslate"><span class="pre">PHOTOMETRIC_RGB</span></code> and <code class="docutils literal notranslate"><span class="pre">COMPRESSION_DEFLATE</span></code></p></li>
<li><p>WEBP output uses all WEBP encoder defaults meaning lossy compression (<code class="docutils literal notranslate"><span class="pre">lossless=0</span></code>) and a default quality of <code class="docutils literal notranslate"><span class="pre">75</span></code> (<code class="docutils literal notranslate"><span class="pre">quality=75</span></code>).</p></li>
</ul>
<p>In Mapnik &gt;= 3.x by default:</p>
<ul class="simple">
<li><p>PNG output is paletted png with no greater than 256 colors (aka. <code class="docutils literal notranslate"><span class="pre">png8</span></code>)</p></li>
</ul>
<p>See the C++ <a class="reference external" href="https://github.com/mapnik/mapnik/blob/master/src/image_util.cpp">image_util.cpp</a> file for definitive defaults that are set for various encoders (as this wiki page may become out of date).</p>
<section id="tiff-output-options">
<h3>TIFF output options<a class="headerlink" href="#tiff-output-options" title="Link to this heading">¶</a></h3>
<p>TIFF output support in Mapnik is experimental and does not output geotiff tags.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Available values</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>compression</p></td>
<td><p>string</p></td>
<td><p>deflate, none, lzw, adobedeflate</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>method</p></td>
<td><p>string</p></td>
<td><p>scanline, stripped, tiled</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>zlevel</p></td>
<td><p>int</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>tile_height</p></td>
<td><p>int</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>tile_width</p></td>
<td><p>int</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>rows_per_strip</p></td>
<td><p>int</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="jpeg-output-options">
<h3>JPEG output options<a class="headerlink" href="#jpeg-output-options" title="Link to this heading">¶</a></h3>
<p>JPEG output support in Mapnik is robust but simple. You can control just one option: the <code class="docutils literal notranslate"><span class="pre">quality</span></code> of the jpeg authored.</p>
<p><code class="docutils literal notranslate"><span class="pre">quality</span></code> can be an integer value between <code class="docutils literal notranslate"><span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">100</span></code> and can be passed to Mapnik by appending the number to the format string like:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">jpeg100</span></code> - will use a quality of <code class="docutils literal notranslate"><span class="pre">100</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jpeg50</span></code> - will use a quality of <code class="docutils literal notranslate"><span class="pre">50</span></code></p></li>
</ul>
</section>
<section id="png-output-options">
<h3>PNG output options<a class="headerlink" href="#png-output-options" title="Link to this heading">¶</a></h3>
<p>There generally two types of PNG Mapnik can author: 1) reduced color paletted png, and 2) full color png. Mapnik also accepts a variety of key:value options that can customize the encoding and may apply to only one kind of PNG type.</p>
<p>So, the two main types can be requested using the formats names:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">png8</span></code> or <code class="docutils literal notranslate"><span class="pre">png256</span></code></p></td>
<td><p>Creates reduced color/quantized paletted png</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">png</span></code>, <code class="docutils literal notranslate"><span class="pre">png24</span></code> or <code class="docutils literal notranslate"><span class="pre">png32</span></code></p></td>
<td><p>Creates full color png with millions of possible colors (and much larger file size)</p></td>
</tr>
</tbody>
</table>
</div>
<p>And the key:value options can be controlled as follows:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>c</p></td>
<td><p>integer, 0-256</p></td>
<td><p>256</p></td>
<td><p>Max number of colors to allow in the image, the fewer colors the smaller the final size, but potential lower visual quality. It is not recommended to reduce this value below 64 unless your rendered map style is very simple because otherwise adjacent tiles might end up with different final colors for the same original color.</p></td>
</tr>
<tr class="row-odd"><td><p>z</p></td>
<td><p>integer, -1 to 9</p></td>
<td><p>-1</p></td>
<td><p>Level of compression - directly maps to <a class="reference external" href="http://www.zlib.net/">zlib</a> options:  -1 is Z_DEFAULT_COMPRESSION, 0 is no compression, 1 is BEST_SPEED, and 9 is BEST_COMPRESSION (available in &gt;= Mapnik 2.x)</p></td>
</tr>
<tr class="row-even"><td><p>t</p></td>
<td><p>integer, 0 to 2</p></td>
<td><p>2</p></td>
<td><p>Transparency mode: 0-no alpha, 1-binary alpha(0 or 255), 2-full alpha range, default is 2, works differently depending on whether you have requested full color png or paletted png. In &gt;= Mapnik 2.2.x <code class="docutils literal notranslate"><span class="pre">png32:t=0</span></code> will create full color png that is <code class="docutils literal notranslate"><span class="pre">rgb</span></code> and not <code class="docutils literal notranslate"><span class="pre">rgba</span></code> (<a class="reference external" href="https://github.com/mapnik/mapnik/issues/1559">more details</a>. If using paletted png then this option is most meaningful for the <code class="docutils literal notranslate"><span class="pre">octree</span></code> encoder (see <code class="docutils literal notranslate"><span class="pre">m=o</span></code> below).</p></td>
</tr>
<tr class="row-odd"><td><p>m</p></td>
<td><p>string, <code class="docutils literal notranslate"><span class="pre">o</span></code> or <code class="docutils literal notranslate"><span class="pre">h</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">h</span></code></p></td>
<td><p>Applies to paletted png only. This is the quantization method: <code class="docutils literal notranslate"><span class="pre">o</span></code> stands for <code class="docutils literal notranslate"><span class="pre">octree</span></code> and <code class="docutils literal notranslate"><span class="pre">h</span></code> stands for <code class="docutils literal notranslate"><span class="pre">hextree</span></code>. The <code class="docutils literal notranslate"><span class="pre">octree</span></code> quantizer only supports limited alpha ranges and so for images with detailed alpha this may produce a poorer quality image. However the <code class="docutils literal notranslate"><span class="pre">octree</span></code> encoder is faster than the <code class="docutils literal notranslate"><span class="pre">hextree</span></code> encoder. The <code class="docutils literal notranslate"><span class="pre">hextree</span></code> encoder is default (as of &gt;= Mapnik 2.3.x) because it produces the highest quality output - nearly visually identical to full color png. If your maps do no contain any alpha (e.g. they have a completely opaque background) then full color png or <code class="docutils literal notranslate"><span class="pre">png8:m=o</span></code> may produce smaller pngs at a faster rate, however we plan to optimize this pathway automatically <a class="reference external" href="https://github.com/mapnik/mapnik/issues/2029">in the future</a>.</p></td>
</tr>
<tr class="row-even"><td><p>g</p></td>
<td><p>float, 1.0 - 2.0</p></td>
<td><p>2.0</p></td>
<td><p>Not likely that you need to change this option. It is the gamma correction for pixel arithmetic in hextree method. 1.0 means no gamma correction</p></td>
</tr>
<tr class="row-odd"><td><p>s</p></td>
<td><p>string, <code class="docutils literal notranslate"><span class="pre">default</span></code>, <code class="docutils literal notranslate"><span class="pre">filtered</span></code>, <code class="docutils literal notranslate"><span class="pre">huff</span></code>, or <code class="docutils literal notranslate"><span class="pre">rle</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">default</span></code></p></td>
<td><p>Not likely that you need to change this option. It is the ZLIB compression strategy. See zlib docs for more details (available in Mapnik &gt;= 2.x)</p></td>
</tr>
<tr class="row-even"><td><p>e</p></td>
<td><p>string, <code class="docutils literal notranslate"><span class="pre">miniz</span></code> or <code class="docutils literal notranslate"><span class="pre">libpng</span></code></p></td>
<td><p>'libpng`</p></td>
<td><p>REMOVED in Mapnik 3.0.10</p></td>
</tr>
<tr class="row-odd"><td><p>f</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">no</span></code>,<code class="docutils literal notranslate"><span class="pre">all</span></code>,<code class="docutils literal notranslate"><span class="pre">fast</span></code> or a combination of <code class="docutils literal notranslate"><span class="pre">none</span></code>,<code class="docutils literal notranslate"><span class="pre">sub</span></code>,<code class="docutils literal notranslate"><span class="pre">up</span></code>,<code class="docutils literal notranslate"><span class="pre">avg</span></code>,<code class="docutils literal notranslate"><span class="pre">paeth</span></code> (for example ```f=sub</p></td>
<td><p>up</p></td>
<td><p>paeth```)</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="webp-output-options">
<h3>WEBP output options<a class="headerlink" href="#webp-output-options" title="Link to this heading">¶</a></h3>
<p>The WEBP API supports a lot of options and types of customization.</p>
<p>We support every option in the <a class="reference external" href="https://developers.google.com/speed/webp/docs/api#advanced_encoding_api">Advanced Encoding API</a> except <code class="docutils literal notranslate"><span class="pre">show_compressed</span></code>. Below we provide basic descriptions for each option name pulled from the Advanced Encoding API documentation. Be aware that they are terse and you should also likely review the <a class="reference external" href="https://developers.google.com/speed/webp/docs/cwebp">cwebp encoder docs</a> for more detailed descriptions of encoding options.</p>
<p>In addition to the webp core options that we expose we support one custom option called <code class="docutils literal notranslate"><span class="pre">alpha</span></code>. If you pass <code class="docutils literal notranslate"><span class="pre">webp:alpha=false</span></code> then an <code class="docutils literal notranslate"><span class="pre">rgb</span></code> webp image will be created instead of an <code class="docutils literal notranslate"><span class="pre">rgba</span></code> image. It is unclear yet whether there is any major benefit to encoding <code class="docutils literal notranslate"><span class="pre">rgb</span></code> webp images and so this option may be removed in the future. It is not recommended to use it. There is also some performance overhead to using this option along with image views (commonly used when metatiling) because, due to the nature of the webp API, <a class="reference external" href="https://github.com/mapnik/mapnik/blob/e618a654985194a95f7cf9c8d48f82e2d1062057/include/mapnik/webp_io.hpp#L92-L113">we have to make a copy of the image buffer in order to strip alpha</a>. At least this was the case when this functionality was developed against libwebp 1.3.1.</p>
<p>We default to all webp defaults. This means that the default encoding is <code class="docutils literal notranslate"><span class="pre">quality=75</span></code> and <code class="docutils literal notranslate"><span class="pre">lossless=0</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">image_hint</span></code> details (from the webp sources) are:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>value</p></th>
<th class="head"><p>meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>default / <code class="docutils literal notranslate"><span class="pre">WEBP_HINT_DEFAULT</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>picture / <code class="docutils literal notranslate"><span class="pre">WEBP_HINT_PICTURE</span></code> (digital picture, like portrait, inner shot)</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>photo / <code class="docutils literal notranslate"><span class="pre">WEBP_HINT_PHOTO</span></code> (outdoor photograph, with natural lighting)</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>graph / <code class="docutils literal notranslate"><span class="pre">WEBP_HINT_GRAPH</span></code> (Discrete tone image (graph, map-tile etc).)</p></td>
</tr>
</tbody>
</table>
</div>
<p>And all the <code class="docutils literal notranslate"><span class="pre">WebPConfig</span></code> based advanced options are:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">WebPConfig</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">lossless</span><span class="p">;</span><span class="w">           </span><span class="c1">// Lossless encoding (0=lossy(default), 1=lossless).</span>
<span class="w">  </span><span class="kt">float</span><span class="w"> </span><span class="n">quality</span><span class="p">;</span><span class="w">          </span><span class="c1">// between 0 (smallest file) and 100 (biggest)</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">method</span><span class="p">;</span><span class="w">             </span><span class="c1">// quality/speed trade-off (0=fast, 6=slower-better)</span>

<span class="w">  </span><span class="n">WebPImageHint</span><span class="w"> </span><span class="n">image_hint</span><span class="p">;</span><span class="w">  </span><span class="c1">// Hint for image type (lossless only for now).</span>

<span class="w">  </span><span class="c1">// Parameters related to lossy compression only:</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">target_size</span><span class="p">;</span><span class="w">        </span><span class="c1">// if non-zero, set the desired target size in bytes.</span>
<span class="w">                          </span><span class="c1">// Takes precedence over the &#39;compression&#39; parameter.</span>
<span class="w">  </span><span class="kt">float</span><span class="w"> </span><span class="n">target_PSNR</span><span class="p">;</span><span class="w">      </span><span class="c1">// if non-zero, specifies the minimal distortion to</span>
<span class="w">                          </span><span class="c1">// try to achieve. Takes precedence over target_size.</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">segments</span><span class="p">;</span><span class="w">           </span><span class="c1">// maximum number of segments to use, in [1..4]</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">sns_strength</span><span class="p">;</span><span class="w">       </span><span class="c1">// Spatial Noise Shaping. 0=off, 100=maximum.</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">filter_strength</span><span class="p">;</span><span class="w">    </span><span class="c1">// range: [0 = off .. 100 = strongest]</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">filter_sharpness</span><span class="p">;</span><span class="w">   </span><span class="c1">// range: [0 = off .. 7 = least sharp]</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">filter_type</span><span class="p">;</span><span class="w">        </span><span class="c1">// filtering type: 0 = simple, 1 = strong (only used</span>
<span class="w">                          </span><span class="c1">// if filter_strength &gt; 0 or autofilter &gt; 0)</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">autofilter</span><span class="p">;</span><span class="w">         </span><span class="c1">// Auto adjust filter&#39;s strength [0 = off, 1 = on]</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">alpha_compression</span><span class="p">;</span><span class="w">  </span><span class="c1">// Algorithm for encoding the alpha plane (0 = none,</span>
<span class="w">                          </span><span class="c1">// 1 = compressed with WebP lossless). Default is 1.</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">alpha_filtering</span><span class="p">;</span><span class="w">    </span><span class="c1">// Predictive filtering method for alpha plane.</span>
<span class="w">                          </span><span class="c1">//  0: none, 1: fast, 2: best. Default if 1.</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">alpha_quality</span><span class="p">;</span><span class="w">      </span><span class="c1">// Between 0 (smallest size) and 100 (lossless).</span>
<span class="w">                          </span><span class="c1">// Default is 100.</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">pass</span><span class="p">;</span><span class="w">               </span><span class="c1">// number of entropy-analysis passes (in [1..10]).</span>

<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">show_compressed</span><span class="p">;</span><span class="w">    </span><span class="c1">// if true, export the compressed picture back.</span>
<span class="w">                          </span><span class="c1">// In-loop filtering is not applied.</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">preprocessing</span><span class="p">;</span><span class="w">      </span><span class="c1">// preprocessing filter (0=none, 1=segment-smooth)</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">partitions</span><span class="p">;</span><span class="w">         </span><span class="c1">// log2(number of token partitions) in [0..3]</span>
<span class="w">                          </span><span class="c1">// Default is set to 0 for easier progressive decoding.</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">partition_limit</span><span class="p">;</span><span class="w">    </span><span class="c1">// quality degradation allowed to fit the 512k limit on</span>
<span class="w">                          </span><span class="c1">// prediction modes coding (0: no degradation,</span>
<span class="w">                          </span><span class="c1">// 100: maximum possible degradation).</span>
<span class="p">};</span>
</pre></div>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, hellowac
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Image IO</a><ul>
<li><a class="reference internal" href="#format-strings">Format strings</a></li>
<li><a class="reference internal" href="#supported-formats">Supported Formats</a></li>
<li><a class="reference internal" href="#default-output-details">Default output details</a><ul>
<li><a class="reference internal" href="#tiff-output-options">TIFF output options</a></li>
<li><a class="reference internal" href="#jpeg-output-options">JPEG output options</a></li>
<li><a class="reference internal" href="#png-output-options">PNG output options</a></li>
<li><a class="reference internal" href="#webp-output-options">WEBP output options</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=f115507d"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/translations.js?v=beaddf03"></script>
    </body>
</html>